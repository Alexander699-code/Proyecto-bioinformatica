Instalamos Miniconda en wsl 
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
chmod +x Miniconda3-latest-Linux-x86_64.sh
./Miniconda3-latest-Linux-x86_64.sh
source ~/.bashrc

#creamos la dependencia 
conda create -y -n bioinfo fastqc fastp spades prokka
conda activate bioinfo
#Ejecutamos Fastqc
fastqc ERR3518912_trim_sampl_PER2_R1.fastq.gz ERR3518912_trim_sampl_PER2_R2.fastq.gz
#observamos la calidad en estos archivos
ERR3518912_trim_sampl_PER2_R1_fastqc.html
ERR3518912_trim_sampl_PER2_R2_fastqc.html
#Ensamblamos 
spades.py --careful \
-1 ERR3518912_trim_sampl_PER2_R1.fastq.gz \
-2 ERR3518912_trim_sampl_PER2_R2.fastq.gz \
-o spades_output
#obtenemos estos archivos
spades_output/contigs.fasta
spades_output/scaffolds.fasta
#observamos la calidad con quast
quast spades_output/contigs.fasta -o quast_output
#Anotamos
prokka contigs.fasta --outdir prokka_OK --prefix klebsiella
#se generara este archivo
prokka_ok/klebsiella.gbk
#Observamos el genoma en https://cgview.ca/ y cargamos el archivo gbk
#### usamos snippy
snippy --outdir snippy_mutante_vs_ref \
       --ref ref_klebsiella.fasta \
       --R1 ERR3518912_trim_samp1_PER2_R1.fastq.gz \
       --R2 ERR3518912_trim_samp1_PER2_R2.fastq.gz \
       --cpus 4
..................................................................................................................
## si queremos bajar secuencias fasta instalamos Entrez para que conecte al ncbi
conda create -n edirect_env -c bioconda entrez-direct
conda activate edirect_env
# buscamos el numero de accesion, seÃ±alamos el formato fasta y le ponemos el nombre 
esearch -db nucleotide -query "NC_016845.1" \
| efetch -format fasta > klebsiella_genome.fasta
#si queremos anotar en simultaneo usamops prokka
prokka klebsiella_genome.1.gb --outdir anotacion_1 --prefix genome1
prokka klebsiella_genome.2.gb --outdir anotacion_2 --prefix genome2


